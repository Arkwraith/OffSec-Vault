---
tags:
  - vulnerability
  - cve
severity:
  - High
Vulnerability Category:
  - Local Privilege Escalation
CVE: CVE-2019-18634
CWE: CWE-120
OS:
  - Linux
---
# Brief
CVE-2019-18634 is a Local Privilege Escalation (LPE) vulnerability in `sudo` (prior to version 1.8.26) that allows users with no sudo permissions to gain root access. It is triggered via a buffer overflow when the `pwfeedback` option is enabled in `/etc/sudoers`.

---
# Overview
Discovered by Joe Vennix, CVE-2019-18634 is a buffer overflow vulnerability affecting `sudo`—a core privilege escalation utility in Linux systems. The flaw resides in the `pwfeedback` feature, which provides visual feedback (asterisks) when typing a password. When this feature is enabled and the user inputs a large volume of characters, it can overflow the input buffer and overwrite adjacent memory.

This results in an exploitable condition that attackers can leverage to execute code with root privileges—without needing to be listed in the sudoers file.

Affected versions:  
- sudo < 1.8.26  
- Only exploitable if `pwfeedback` is explicitly enabled.

---
# Signals
- `sudo` version < 1.8.26 (`sudo -V`)
- `pwfeedback` option set in `/etc/sudoers`:
	```bash
	sudo grep pwfeedback /etc/sudoers
	```
- Segmentation fault upon entering long password via `sudo`
    
- No sudo permissions required for the exploit to work
    
- Can enumerate with:
    - [linpeas](Tools/linpeas) -> flags vulnerable sudo configs        
    - [sudo -l](Tools/sudo) -> confirms lack of sudo privileges

---
# Exploitation

## Method
1. Confirm `pwfeedback` is enabled
	`sudo grep pwfeedback /etc/sudoers`
2. Check `sudo` version
	`sudo -V`
3. Compile or run the exploit (e.g. `exploit` compiled from exploit.c by Saleem Rashid)
	`./exploit`
	- If vulnerable, will yield a root shell
## Under the Hood
- `pwfeedback` changes how input is handled by the terminal during password entry.
- The terminal's input handling code fails to properly bounds-check user input when `pwfeedback` is enabled.
- An attacker can trigger a buffer overflow by feeding excessive characters into the password prompt.
- This overflows into adjacent memory regions, allowing the attacker to hijack control flow and execute arbitrary code as root.

## Alternate Detection
- Try triggering a segmentation fault with: `perl -e 'print "A" x 1000' | sudo -S id`
- Check `/var/log/syslog` dmesg for `segfault` messages related to sudo
- Manual code or config audit for pwfeedback

---
# Pattern
- **Vulnerability Class:** Buffer Overflow (`CWE-120`)
- **Privilege Escalation Vector:** Malformed password input in sudo with `pwfeedback` enabled
- **Trigger Mechanism:** Terminal input overflow during sudo password prompt
- **Exploit Mechanism:** Memory corruption leading to code execution

## Related Techniques
-  [Buffer Overflow](Techniques/Buffer Overflow)
- [Sudo Misconfiguration](Techniques/Sudo Misconfiguration)
- [Local Privilege Escalation](Techniques/Local Privilege Escalation)

---
# Tools
- [linpeas](Tools/linpeas) -> Flag sudoers config and sudo version
- [gcc](Tools/gcc) -> Compile C-based PoC
- [exploit-db](Tools/exploitdb) -> Download exploit PoC
- perl -> Used in quick segfault PoC
- GitHub PoC:
    - [SaleemRashid/sudo-cve-2019-18634](https://github.com/saleemrashid/sudo-cve-2019-18634)

---
# Mitigation

## Permanent Fix
- Upgrade `sudo` to version 1.8.26 or higher: `sudo apt update && sudo apt upgrade sudo`
- Ensure patched binaries are in use: `sudo -V`

## Temporary Workaround
- Disable `pwfeedback` in `/etc/sudoers`: `Defaults !pwfeedback`
- Use `visudo` to make changes safely: `sudo visudo`

## Verify
- Run the exploit or PoC; if patched, it will no longer return root or segfault
- Confirm version is >= 1.8.26
- Confirm `pwfeedback` is not present or is disabled

---
# References

- THM Room - CVE-2019-18634
- [Exploit on GitHub - Saleem Rashid](https://github.com/saleemrashid/sudo-cve-2019-18634)
- Sudo Security Advisory
- NVD: CVE-2019-18634
- Qualys Advisory (Archived)
---
# Notes
- Only exploitable if `pwfeedback` is enabled, which is not default on most distributions.
- Notably enabled by default on some distros like Linux Mint and Elementary OS.
- No sudo privileges are required—any local user may attempt the exploit.
- Good example of an aesthetic feature introducing a critical security flaw.

---
# Related CTFs

